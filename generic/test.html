<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta name="keywords" content="math,science" />
		<script type="text/javascript">
			function getParameter(name) {
				var value = new RegExp(name+"=([^&]*)","i").exec(window.location);
				if (value!=null && value.length>1) {
					value = decodeURIComponent(value[1].replace(/\+/g,' '));
				} else {
					value = null;
				}
				return value;
			}
		    var tech = getParameter("tech");
		    var _wrs_config_relative;
		    var _wrs_config_script;
		    var _wrs_config_extension;
		    if (tech!=null) {
		        if (tech=="php") {
		            _wrs_config_relative  = true;
		            _wrs_config_extension  = ".php";
		            _wrs_config_script = "integration";
		        } else if (tech=="aspx") {
		            _wrs_config_relative  = true;
		            _wrs_config_extension = ".aspx";
		            _wrs_config_script = "integration";
		        } else if (tech=="java") {
		            _wrs_config_relative  = true;
		            _wrs_config_extension = "";
		            _wrs_config_script = "app";
		        }
		    } else {
		        window.location = "tests/choose.html";
		    }
			
			var content = getParameter("content");
		</script>
		<script type="text/javascript" src="core/display.js"></script>
		<script type="text/javascript" src="core/core.js"></script>
		<script type="text/javascript" src="tests/generic_demo.js"></script>
		
		<script type="text/javascript">
			wrs_addEvent(window, 'load', function () {
				// Hide the textarea
				var textarea = document.getElementById('example');
				textarea.style.display = 'none';

				// Create the toolbar
				var toolbar = document.createElement('div');
				toolbar.id = textarea.id + '_toolbar';
				
				// Create the WYSIWYG editor
				var iframe = document.createElement('iframe');
				iframe.id = textarea.id + '_iframe';
				
				wrs_addEvent(iframe, 'load', function () {
					// Setting design mode ON
					iframe.contentWindow.document.designMode = 'on';
					
					// Setting the content
					if (iframe.contentWindow.document.body) {
						iframe.contentWindow.document.body.innerHTML = textarea.value;
					
						// WE INIT THE WIRIS PLUGIN HERE
						wrs_int_init(textarea.id);
					}
				});
				
				iframe.src = 'tests/generic_demo.html';		// We set an empty document instead of about:blank for use relative paths for images
				iframe.width = 500;
				iframe.height = 200;

				// Insert the WYSIWYG editor before the textarea
				textarea.parentNode.insertBefore(iframe, textarea);
				
				// Insert the toolbar before the WYSIWYG editor
				iframe.parentNode.insertBefore(toolbar, iframe);
				
				// When the user submits the form, set the textarea value with the WYSIWYG editor content
				var form = document.getElementById('exampleForm');
				
				wrs_addEvent(form, 'submit', function () {
					//textarea.value = iframe.contentWindow.document.body.innerHTML;
					// In our case, the plugin is who sets the textarea content.
				});
			});
		</script>
		
		<title>WIRIS Plugin generic integration on PHP | Educational mathematics</title>
	</head>
	<body>
		<h1><a href="http://www.wiris.com"><img src="http://www.wiris.com/en/system/files/attachments/889/wiris_50.png" title="WIRIS" /></a> Test page for WIRIS plugins</h1>
	
		<form id="exampleForm" method="GET">
			<textarea id="example" name="content" cols="50" rows="10">
			Copy content from url
			</textarea><br />
			<input type="hidden" id="tech" name="tech" />
			<script>
				document.getElementById("tech").value = tech;
				document.getElementById("example").value = content;
			</script>
			
			<input id="previewButton" type="submit" value="Preview"/>
		</form>
		
		<h2>Preview</h2>
		
		<div id="previewBox">
			<script>
				if (content!=null && content.length>0) {
					document.write(content);
				} else {
					document.write('<span id="previewMessage">Press the "Preview" button.</span>');
				}
			</script>
		</div>
	</body>
</html>
